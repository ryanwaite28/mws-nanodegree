<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Normalize.css for better cross-browser consistency -->
  <!-- <link rel="stylesheet" href="https://normalize-css.googlecode.com/svn/trunk/normalize.css" /> -->

  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#252831">

  <link rel="shortcut icon" href="/favicon.ico"/>

  <style>
  @charset "utf-8";body,td,th,p{font-family:Arial,Helvetica,sans-serif;font-size:10pt;color:#333;line-height:1.5}body{background-color:#fdfdfd;margin:0}ul,li{font-family:Arial,Helvetica,sans-serif;font-size:10pt;color:#333}a{color:orange;text-decoration:none}a:hover,a:focus{color:#3397db;text-decoration:none}a img{border:none 0 #fff}h1,h2,h3,h4,h5,h6{font-family:Arial,Helvetica,sans-serif;margin:0 0 20px}article,aside,canvas,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}#maincontent{background-color:#f3f3f3;min-height:100%;padding-top:60px}#footer{background-color:#444;color:lightgrey;font-size:8pt;letter-spacing:1px;padding:25px 0;text-align:center;text-transform:uppercase;position:fixed;bottom:0;right:0;width:100%}nav{position:fixed;width:100%;background-color:#252831;text-align:center;z-index:100}nav h1{margin:auto;height:60px;line-height:60px;vertical-align:middle}nav h1 a{color:#fff;font-size:14pt;font-weight:200;letter-spacing:10px;text-transform:uppercase}#breadcrumb{padding:15px;list-style:none;background-color:#eee;font-size:17px;margin:0;max-width:100%}#breadcrumb li{display:inline}#breadcrumb li+li:before{padding:8px;color:black;content:"/\00a0"}#breadcrumb li a{color:#0059b3;text-decoration:none}#breadcrumb li a:hover{color:#0275d8;text-decoration:underline}#map{min-height:275px;height:50vh;width:100%;background-color:#ccc}.filter-options{height:auto;background-color:#0059b3;align-items:center;padding:10px}.filter-options h2{color:white;font-size:1.5rem;font-weight:400;height:45px;line-height:45px;vertical-align:middle;margin:0 10px;text-align:center}.filter-options select{background-color:white;border:1px solid #fff;font-family:Arial,sans-serif;font-size:11pt;height:35px;letter-spacing:0;margin:10px;padding:0 10px;width:200px;max-width:100%}.filter-options select:focus{box-shadow:0 1px 3px #252831}.select-label{color:white;font-size:1rem;font-weight:400;margin:10px}#restaurants-list{list-style:none;margin:0;padding:35px 15px 70px;text-align:center;display:flex;flex-flow:row wrap;justify-content:center}#restaurants-list li{font-family:Arial,sans-serif;margin:15px;min-height:380px;padding:0;text-align:left;width:325px;max-width:100%;box-shadow:0 1px 3px lightgrey;border:1px solid lightgrey}#restaurants-list li>div.restaurant-info-container{padding:10px;background:white}#restaurants-list .restaurant-img{background-color:#ccc;display:block;margin:0;max-width:100%;min-height:248px;min-width:100%}#restaurants-list li h1{color:#A86500;font-family:Arial,sans-serif;font-size:14pt;font-weight:200;letter-spacing:0;line-height:1.3;margin:20px 0 10px;text-transform:uppercase}#restaurants-list p{margin:0;font-size:11pt}#restaurants-list li a{background-color:#A86500;color:#fff;display:inline-block;font-size:10pt;margin:15px 0 0;padding:8px 30px 10px;text-align:center;text-decoration:none;text-transform:uppercase}#select-container{display:flex;flex-flow:row wrap;justify-content:center}#navbar{border-bottom:1px solid #d9d9d9}#middle-box{width:725px;max-width:100%;padding:30px 15px 60px}.middlr{display:block;margin:auto}.width-responsive{max-width:100%}#map-container,.inside #map-container{border-bottom:1px solid #d9d9d9}#restaurant-name{color:#f18200;font-family:Arial,sans-serif;font-size:20pt;font-weight:200;letter-spacing:0;margin:15px 0 30px;text-transform:uppercase;line-height:1.1;text-align:center}#restaurant-img{width:100%}#restaurant-address{font-size:12pt;margin:10px 0}#restaurant-cuisine{background-color:#333;color:#ddd;font-size:12pt;font-weight:300;letter-spacing:10px;margin:0 0 20px;padding:2px 0;text-align:center;text-transform:uppercase;width:100%}#restaurant-container,#reviews-container{width:100%;padding:15px 0}#reviews-container h2{color:#f58500;font-size:24pt;font-weight:300;letter-spacing:-1px;padding-bottom:1pt}#reviews-list{margin:0;padding:0}#reviews-list li{background-color:#fff;display:block;list-style-type:none;margin-bottom:30px;overflow:hidden;position:relative;width:100%;box-shadow:0 1px 3px lightgrey;border-top-right-radius:15px;border-bottom-left-radius:15px}#restaurant-hours td{color:#666}p.review-name{font-size:1.75rem;background:#333;color:white;letter-spacing:5px;font-weight:150;padding:15px 30px;margin:0}.review-info-container{padding:15px 30px}.transition{-webkit-transition:transition 0.3s;-moz-transition:transition 0.3s;-o-transition:transition 0.3s;-ms-transition:transition 0.3s;transition:0.3s}.text-center{text-align:center}.rating-span{padding:10px;margin:5px 0;display:inline-block;font-size:1rem}.rating-bad{background:#ff704d;color:white}.rating-fair{background:#ff944d}.rating-good{background:#093;color:white}@media (max-width:875px){#select-container{display:block;flex-flow:initial;justify-content:initial}#middle-box{width:auto}.filter-options select{display:block;margin:auto;margin-bottom:10px}.select-label{text-align:center;display:block}}@media (max-width:475px){nav h1 a{font-size:8pt;letter-spacing:5px}#restaurants-list .restaurant-img{min-height:auto}#restaurants-list li h1{font-size:12pt}#restaurants-list li{min-height:auto}#restaurants-list li a{padding:15px}.filter-options h2{font-size:1rem}#breadcrumb{padding:5px}}
  </style>

  <style>
  .input-s1 {
    width: 375px;
    max-width: 95%;
    padding: 5px;
    line-height: normal;
    border: 1px solid grey;
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    -o-border-radius: 2px;
    -ms-border-radius: 2px;
  }
  .middlr {
    display: block;
    margin: auto;
  }
  #create-edit-review-form {
    margin: 45px 0px;
    padding: 10px;
    background-color: #fff;
    max-width: 100%;
    box-shadow: 0 1px 3px lightgrey;
  }
  #submit-form-btn {
    border: 0px;
    color: white;
    background: #006600;
    padding: 10px;
    cursor: pointer;
  }
  #cancel-editing-btn {
    border: 0px;
    color: white;
    background: grey;
    padding: 10px;
    cursor: pointer;
    display: none;
  }
  #create-edit-review-form label {
    display: block;
    margin: auto;
    text-align: center;
    line-height: 1.5;
    font-family: Arial,Helvetica,sans-serif;
    font-size: 1rem;
  }
  #form-header {
    text-align: center;
  }
  </style>

  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

  <script type="application/javascript" charset="utf-8">
    (function(){let sw=null;if(navigator.serviceWorker && navigator.serviceWorker.register){navigator.serviceWorker.register('/sw.min.js') .then(registration=>{console.log('serviceWorker registered!',registration);sw=registration}) .catch(error=>{console.log(error)})}})()
  </script>

  <title>Restaurant Info</title>
</head>

<body class="inside">
  <header>
    <nav role="navigation" id="navbar">
      <h1 id="nav-text"><a title="Home Page" href="/">Restaurant Reviews</a></h1>
      <ul id="breadcrumb">
        <li><a title="Home Page" href="/">Home</a></li>
        <li><a title="Skip To Main" href="#middle-box">Skip To Main</a></li>
      </ul>
    </nav>
  </header>

  <main id="maincontent">
    <div id="">
      <div id="">
        <section id="map-container">
          <div id="map" role="application" aria-hidden="true"></div>
        </section>
      </div>

      <div id="middle-box" class="middlr">
        <section id="restaurant-container" role="contentinfo" aria-label="Restaurant Details">
          <h2 id="restaurant-name"></h2>
          <img id="restaurant-img">
          <p id="restaurant-cuisine"></p>
          <p id="restaurant-address"></p>
          <table id="restaurant-hours"></table>
        </section>

        <hr/>

        <section id="reviews-container" role="contentinfo" aria-label="Reviews List">
          <ul id="reviews-list"></ul>
        </section>

        <hr/>

        <form id="create-edit-review-form" aria-label="create/edit review form">
          <h2 id="form-header"></h2>
          <button title="Cancel Editing" class="middlr" type="button" id="cancel-editing-btn">Cancel Edit</button>
          <br/>
          <label for="name-field">
            Name
            <input class="input-s1 middlr" id="name-field" type="text" name="name-field" placeholder="Enter a name">
            <br/>
          </label>
          <label for="rating-field">
            Rating
            <input class="input-s1 middlr" id="rating-field" type="number" min="1" max="5" name="rating-field" placeholder="Enter a rating">
            <br/>
          </label>
          <label for="comments-field">
            Comment
            <textarea style="min-height: 20vh;" class="input-s1 middlr" id="comments-field" type="text" name="comments-field" placeholder="Enter a comment"></textarea>
            <br/>
          </label>
          <button title="Submit form button" class="middlr" type="button" id="submit-form-btn">Submit</button>
        </form>
      </div>
    </div>



  </main>
  <!-- End main -->

  <!-- Beginning footer -->
  <footer id="footer">
    Copyright (c) 2017 <a title="Home Page" href="/"><strong>Restaurant Reviews</strong></a> All Rights Reserved.
  </footer>
  <!-- End footer -->

  <!-- Beginning scripts -->
  <!-- Database helpers -->
  <script type="text/javascript" src="js/dbhelper.min.js"></script>
  <!-- Main javascript file -->
  <script type="text/javascript">
  (function(){let restaurant;var map;let editing=!1;let editingBtn;let submitBtn;window.initMap=()=>{try{DBHelper.syncReviews().then(function(){init()})}
catch(e){console.log('error: could not sync reviews...');init()}}
function init(){editingBtn=document.getElementById('cancel-editing-btn');editingBtn.addEventListener('click',function(){setEditing()});submitBtn=document.getElementById('submit-form-btn');submitBtn.addEventListener('click',function(){submitReview()});fetchRestaurantFromURL((error,restaurant)=>{setEditing();if(error){console.error(error)}else{self.map=new google.maps.Map(document.getElementById('map'),{zoom:16,center:restaurant.latlng,scrollwheel:!1});fillBreadcrumb();DBHelper.mapMarkerForRestaurant(self.restaurant,self.map);DBHelper.fetchReviews(self.restaurant.id,(error,reviews)=>{fillReviewsHTML(reviews)})}})}
function submitReview(){var formdata=getFormValues();if(!/[a-zA-Z]{2,}$/gi.test(formdata.name)){alert('name input must be letters only, minimum of 2 characters');return}
if(!/[1-5]{1}$/gi.test(formdata.rating)){alert('rating input must be a number, 1-5');return}
if(formdata.comments.length<3){alert('comments input must be minimum of 3 characters');return}
if(!editing){formdata.restaurant_id=Number(getParameterByName('id'))}
try{DBHelper.submitReview(formdata,editing).then(function(review){let alertMSG=editing?'Edited Review!':'Created Review!';alert(alertMSG);let new_review_em=createReviewHTML(review);if(editing){let old_review_em=document.getElementById(`review-li-${review.id}`);let parent_em=old_review_em.parentElement;parent_em.replaceChild(new_review_em,old_review_em)}
else{const ul=document.getElementById('reviews-list');ul.appendChild(new_review_em)}
setEditing();var element=document.getElementById(`review-li-${review.id}`);if(element.scrollIntoView&&element.scrollIntoView.constructor===Function){element.scrollIntoView(!0)}}).catch(function(e){console.log('error...',e);var msg=editing?'Could not edit this review. please try again later.':'Could not create review. Please Check network connection.';alert(msg)})}
catch(e){console.log('error...',e);var msg=editing?'Could not edit this review. please try again later.':'Could not create review. Please Check network connection.';alert(msg)}}
function getFormValues(){return{name:document.getElementById('name-field').value.trim(),rating:document.getElementById('rating-field').value.trim(),comments:document.getElementById('comments-field').value.trim()}}
function setEditing(review){if(review){editing=review;document.getElementById('form-header').innerHTML=`Edit ${editing.name}'s review`;document.getElementById('name-field').value=editing.name;document.getElementById('rating-field').value=editing.rating;document.getElementById('comments-field').value=editing.comments;editingBtn.style.display='block'}
else{editing=!1;document.getElementById('form-header').innerHTML=`Create a review`;document.getElementById('name-field').value='';document.getElementById('rating-field').value='';document.getElementById('comments-field').value='';editingBtn.style.display='none'}}
function goToBottom(){window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight)}
fetchRestaurantFromURL=(callback)=>{if(self.restaurant){callback(null,self.restaurant)
return}
const id=getParameterByName('id');if(!id){error='No restaurant id in URL'
callback(error,null)}else{DBHelper.fetchRestaurantById(id,(error,restaurant)=>{self.restaurant=restaurant;if(!restaurant){console.error(error);return}
fillRestaurantHTML();callback(null,restaurant)})}}
fillRestaurantHTML=(restaurant=self.restaurant)=>{const name=document.getElementById('restaurant-name');name.innerHTML=restaurant.name;const address=document.getElementById('restaurant-address');address.innerHTML=restaurant.address;const image=document.getElementById('restaurant-img');image.className='restaurant-img';image.setAttribute("alt",`${restaurant.name} (${restaurant.neighborhood})`);image.src=DBHelper.imageUrlForRestaurant(restaurant);const cuisine=document.getElementById('restaurant-cuisine');cuisine.innerHTML=restaurant.cuisine_type;const favBtn=DBHelper.renderFavBtn(restaurant);document.getElementById('restaurant-container').appendChild(favBtn);if(restaurant.operating_hours){fillRestaurantHoursHTML()}}
fillRestaurantHoursHTML=(operatingHours=self.restaurant.operating_hours)=>{const hours=document.getElementById('restaurant-hours');for(let key in operatingHours){const row=document.createElement('tr');const day=document.createElement('td');day.innerHTML=key;row.appendChild(day);const time=document.createElement('td');time.innerHTML=operatingHours[key];row.appendChild(time);hours.appendChild(row)}}
fillReviewsHTML=(reviews=self.restaurant.reviews)=>{const container=document.getElementById('reviews-container');const title=document.createElement('h2');title.innerHTML='Reviews';title.className='text-center';container.appendChild(title);if(!reviews){const noReviews=document.createElement('p');noReviews.innerHTML='No reviews yet!';container.appendChild(noReviews);return}
const ul=document.getElementById('reviews-list');reviews.forEach(review=>{ul.appendChild(createReviewHTML(review))});container.appendChild(ul)}
determineRatingClass=(ratingNumber)=>{let className;if(ratingNumber<=2){className='rating-bad'}
if(ratingNumber==3){className='rating-fair'}
if(ratingNumber>=4){className='rating-good'}
return className}
createReviewHTML=(review)=>{const li=document.createElement('li');li.setAttribute("id",`review-li-${review.id}`);li.setAttribute("data-restaurant-id",review.restaurant_id);const name=document.createElement('p');name.setAttribute("id",`review-name-${review.id}`);name.innerHTML=review.name;name.className='review-name';li.appendChild(name);const div=document.createElement('div');div.className='review-info-container';const created=document.createElement('p');created.innerHTML='<span>'+'<strong>Created:</strong> '+(new Date(review.createdAt)).toDateString()+'</span>';created.style.fontSize='1.25rem';div.appendChild(created);const updated=document.createElement('p');updated.innerHTML='<span>'+'<strong>Updated:</strong> '+(new Date(review.updatedAt)).toDateString()+'</span>';updated.style.fontSize='1.25rem';div.appendChild(updated);const rating=document.createElement('p');const ratingSpan=document.createElement('span');ratingSpan.setAttribute("id",`rating-${review.id}`);ratingSpan.className=determineRatingClass(review.rating);ratingSpan.className+=" rating-span";ratingSpan.innerHTML=`Rating: ${review.rating}`;rating.appendChild(ratingSpan);div.appendChild(rating);const comments=document.createElement('p');comments.setAttribute("id",`review-comments-${review.id}`);comments.innerHTML=review.comments;comments.style.fontSize='1.0rem';div.appendChild(comments);const deleteBtn=DBHelper.renderDeleteReviewBtn(review);div.appendChild(deleteBtn);const editBtn=DBHelper.renderEditReviewBtn(review);editBtn.addEventListener('click',function(){(function(){let this_review=review;setEditing(this_review);goToBottom()})()})
div.appendChild(editBtn);li.append(div);return li}
fillBreadcrumb=(restaurant=self.restaurant)=>{const breadcrumb=document.getElementById('breadcrumb');const li=document.createElement('li');li.innerHTML=restaurant.name;breadcrumb.appendChild(li)}
getParameterByName=(name,url)=>{if(!url)
url=window.location.href;name=name.replace(/[\[\]]/g,'\\$&');const regex=new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),results=regex.exec(url);if(!results)
return null;if(!results[2])
return'';return decodeURIComponent(results[2].replace(/\+/g,' '))}
formatDate=(date_num)=>{var date=new Date(date_num)}})()
  </script>
  <!-- Google Maps -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDo-h8Qke5DFQrz60Ujspe4agv4JHBKPzc&libraries=places&callback=initMap"></script>
  <!-- End scripts -->

</body>

</html>
